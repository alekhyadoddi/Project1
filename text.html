```<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://code.jquery.com/jquery-3.4.0.js" integrity="sha256-DYZMCC8HTC+QDr5QNaIcfR7VSPtcISykd+6eSmBW5qo=" crossorigin="anonymous"></script>
    <script src="Test.js"></script>
    <title>Document</title>

</head>

<body>
    <input type="file" onchange="previewFile()"><br>
    <img src="" height="200" alt="Image preview...">

    <script>
   
     
        var getDataUrl = function (img) {
        var canvas = document.createElement('canvas')
        var ctx = canvas.getContext('2d')
        var a ; 
        canvas.width = img.width
        canvas.height = img.height
        ctx.drawImage(img, 0, 0)

        // If the image is not png, the format
        // must be specified here
        return canvas.toDataURL()
        }
 
        // You can then get the data URL when the image got loaded:
        var img = document.querySelector('img')

        img.addEventListener('load', function (event) {
        dataUrl = getDataUrl(event.currentTarget)
        console.log(dataUrl.slice(22));
        
         data = dataUrl.slice(22);
         queryURL = "https://api-us.faceplusplus.com/facepp/v3/detect?api_key=T58NXq8bmLhg7Szt9i_TT2POiN-YE_A0&api_secret=tDmaCtP_71ZtClEXw2dvxQL9Q8eGfgiW&image_base64="+data+"&return_attributes=gender,age,emotion";
         $.ajax({
            url: "https://mighty-brook-95893.herokuapp.com/cors",
            method: "POST",
            data: {
            method: "POST",
            url: queryURL,
            key: "efd92cf6cc5e7649916c4e73939e6281"
    }
    
  }).then (function(response){
    console.log(response);
    // return response ;
    


});
        })
       
        
        
      
   
      



        function previewFile() {
              var preview = document.querySelector('img');
              var file    = document.querySelector('input[type=file]').files[0];
              var reader  = new FileReader();
            
              reader.addEventListener("load", function () {
                preview.src = reader.result;
              }, false);
                console.log(reader.result);
              if (file) {
                reader.readAsDataURL(file);
                console.log(file);
              }
    }
    </script>
</body>

</html>


